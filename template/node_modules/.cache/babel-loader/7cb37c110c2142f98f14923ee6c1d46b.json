{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n          if (desc.get || desc.set) {\n            Object.defineProperty(newObj, key, desc);\n          } else {\n            newObj[key] = obj[key];\n          }\n        }\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar noop = function noop() {};\n\nvar _id = 0;\n\nvar generateId = function generateId() {\n  return \"simplemde-editor-\".concat(++_id);\n};\n\nvar SimpleMDEEditor =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(SimpleMDEEditor, _React$PureComponent);\n\n  function SimpleMDEEditor(props) {\n    var _this;\n\n    _classCallCheck(this, SimpleMDEEditor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SimpleMDEEditor).call(this, props));\n    _this.keyChange = false;\n    _this.state = {\n      value: _this.props.value || \"\"\n    };\n    _this.id = _this.props.id ? _this.props.id : generateId();\n    _this.simpleMde = null;\n    _this.editorEl = null;\n    _this.editorToolbarEl = null;\n\n    _this.createEditor = function () {\n      var SimpleMDE = require(\"easymde\");\n\n      var initialOptions = {\n        element: document.getElementById(_this.id),\n        initialValue: _this.props.value\n      };\n      var allOptions = Object.assign({}, initialOptions, _this.props.options);\n      _this.simpleMde = new SimpleMDE(allOptions);\n    };\n\n    _this.eventWrapper = function () {\n      _this.keyChange = true;\n\n      _this.setState({\n        value: _this.simpleMde.value()\n      });\n\n      _this.props.onChange(_this.simpleMde.value());\n    };\n\n    _this.removeEvents = function () {\n      if (_this.editorEl && _this.editorToolbarEl) {\n        _this.editorEl.removeEventListener(\"keyup\", _this.eventWrapper);\n\n        _this.editorEl.removeEventListener(\"paste\", _this.eventWrapper);\n\n        _this.editorToolbarEl.removeEventListener(\"click\", _this.eventWrapper);\n      }\n    };\n\n    _this.addEvents = function () {\n      if (_this.elementWrapperRef && _this.simpleMde) {\n        _this.editorEl = _this.elementWrapperRef;\n        _this.editorToolbarEl = _this.elementWrapperRef.getElementsByClassName(\"editor-toolbar\")[0];\n\n        _this.editorEl.addEventListener(\"keyup\", _this.eventWrapper);\n\n        _this.editorEl.addEventListener(\"paste\", _this.eventWrapper);\n\n        _this.editorToolbarEl && _this.editorToolbarEl.addEventListener(\"click\", _this.eventWrapper);\n\n        _this.simpleMde.codemirror.on(\"cursorActivity\", _this.getCursor);\n\n        var _events = _this.props.events; // Handle custom events\n\n        _events && Object.entries(_events).forEach(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n              eventName = _ref2[0],\n              callback = _ref2[1];\n\n          if (eventName && callback) {\n            _this.simpleMde && _this.simpleMde.codemirror.on(eventName, callback);\n          }\n        });\n      }\n    };\n\n    _this.getCursor = function () {\n      // https://codemirror.net/doc/manual.html#api_selection\n      if (_this.props.getLineAndCursor) {\n        _this.props.getLineAndCursor(_this.simpleMde.codemirror.getDoc().getCursor());\n      }\n    };\n\n    _this.getMdeInstance = function () {\n      if (_this.props.getMdeInstance) {\n        _this.props.getMdeInstance(_this.simpleMde);\n      }\n    };\n\n    _this.addExtraKeys = function () {\n      // https://codemirror.net/doc/manual.html#option_extraKeys\n      if (_this.props.extraKeys) {\n        _this.simpleMde.codemirror.setOption(\"extraKeys\", _this.props.extraKeys);\n      }\n    };\n\n    _this.elementWrapperRef = null;\n\n    _this.setElementWrapperRef = function (element) {\n      _this.elementWrapperRef = element;\n    };\n\n    return _this;\n  }\n\n  _createClass(SimpleMDEEditor, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (typeof window !== undefined) {\n        this.createEditor();\n        this.addEvents();\n        this.addExtraKeys();\n        this.getCursor();\n        this.getMdeInstance();\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (!this.keyChange && this.props.value !== this.state.value && // This is somehow fixes moving cursor for controlled case\n      this.props.value !== prevProps.value // This one fixes no value change for uncontrolled input. If it's uncontrolled prevProps will be the same\n      ) {\n          this.simpleMde.value(this.props.value || \"\");\n        }\n\n      this.keyChange = false;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.editorEl !== null && this.editorEl !== undefined) {\n        this.removeEvents();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          events = _this$props.events,\n          value = _this$props.value,\n          options = _this$props.options,\n          children = _this$props.children,\n          extraKeys = _this$props.extraKeys,\n          getLineAndCursor = _this$props.getLineAndCursor,\n          getMdeInstance = _this$props.getMdeInstance,\n          label = _this$props.label,\n          onChange = _this$props.onChange,\n          id = _this$props.id,\n          rest = _objectWithoutProperties(_this$props, [\"events\", \"value\", \"options\", \"children\", \"extraKeys\", \"getLineAndCursor\", \"getMdeInstance\", \"label\", \"onChange\", \"id\"]);\n\n      return React.createElement(\"div\", Object.assign({\n        id: \"\".concat(this.id, \"-wrapper\")\n      }, rest, {\n        ref: this.setElementWrapperRef\n      }), label && React.createElement(\"label\", {\n        htmlFor: this.id\n      }, \" \", label, \" \"), React.createElement(\"textarea\", {\n        id: this.id\n      }));\n    }\n  }]);\n\n  return SimpleMDEEditor;\n}(React.PureComponent);\n\nexports.default = SimpleMDEEditor;\nSimpleMDEEditor.defaultProps = {\n  events: {},\n  onChange: noop,\n  options: {}\n};","map":{"version":3,"sources":["../src/index.tsx"],"names":["noop","_id","generateId","SimpleMDEEditor","React","PureComponent","keyChange","defaultProps","events","onChange","options","state","value","id","simpleMde","editorEl","editorToolbarEl","prevProps","SimpleMDE","require","initialOptions","element","document","initialValue","allOptions","Object","eventName","callback","children","extraKeys","getLineAndCursor","getMdeInstance","label","rest","setElementWrapperRef"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport * as SimpleMDE from \"easymde\";\nimport { KeyMap, DOMEvent, Editor } from \"codemirror\";\n\nconst noop = () => {};\nlet _id = 0;\n\nconst generateId = () => `simplemde-editor-${++_id}`;\n\ntype CodemirrorEvents =\n  | \"change\"\n  | \"changes\"\n  | \"beforeChange\"\n  | \"cursorActivity\"\n  | \"beforeSelectionChange\"\n  | \"viewportChange\"\n  | \"gutterClick\"\n  | \"focus\"\n  | \"blur\"\n  | \"scroll\"\n  | \"update\"\n  | \"renderLine\";\n\ntype SimpleMdeToCodemirror = { \n  [E in CodemirrorEvents | DOMEvent]?: Editor[\"on\"]\n};\n\nexport interface SimpleMDEEditorProps {\n  id?: string;\n  label?: string;\n  onChange: (value: string) => void | any;\n  value?: string;\n  className?: string;\n  extraKeys?: KeyMap;\n  options?: SimpleMDE.Options;\n  events?: SimpleMdeToCodemirror;\n  getMdeInstance?: (instance: SimpleMDE) => void | any;\n  getLineAndCursor?: (position: CodeMirror.Position) => void | any;\n}\n\ntype SimpleMDEEditorState = {\n  value: string;\n};\n\nexport default class SimpleMDEEditor extends React.PureComponent<\n  SimpleMDEEditorProps,\n  SimpleMDEEditorState\n> {\n  private elementWrapperRef: HTMLDivElement | null;\n  private setElementWrapperRef: (element: HTMLDivElement) => void;\n  private keyChange = false;\n\n  static defaultProps = {\n    events: {},\n    onChange: noop,\n    options: {}\n  };\n\n  state = {\n    value: this.props.value || \"\"\n  };\n\n  id = this.props.id ? this.props.id : generateId();\n  simpleMde: SimpleMDE | null = null;\n  editorEl: HTMLDivElement | null = null;\n  editorToolbarEl: Element | null = null;\n\n  constructor(props: SimpleMDEEditorProps) {\n    super(props);\n    this.elementWrapperRef = null;\n    this.setElementWrapperRef = (element: HTMLDivElement) => {\n      this.elementWrapperRef = element;\n    };\n  }\n\n  componentDidMount() {\n    if (typeof window !== undefined) {\n      this.createEditor();\n      this.addEvents();\n      this.addExtraKeys();\n      this.getCursor();\n      this.getMdeInstance();\n    }\n  }\n\n  componentDidUpdate(prevProps: SimpleMDEEditorProps) {\n    if (\n      !this.keyChange &&\n      this.props.value !== this.state.value && // This is somehow fixes moving cursor for controlled case\n      this.props.value !== prevProps.value // This one fixes no value change for uncontrolled input. If it's uncontrolled prevProps will be the same\n    ) {\n      this.simpleMde!.value(this.props.value || \"\");\n    }\n    this.keyChange = false;\n  }\n\n  componentWillUnmount() {\n    if (this.editorEl !== null && this.editorEl !== undefined) {\n      this.removeEvents();\n    }\n  }\n\n  createEditor = () => {\n    const SimpleMDE = require(\"easymde\");\n    const initialOptions = {\n      element: document.getElementById(this.id),\n      initialValue: this.props.value\n    };\n\n    const allOptions = Object.assign({}, initialOptions, this.props.options);\n    this.simpleMde = new SimpleMDE(allOptions);\n  };\n\n  eventWrapper = () => {\n    this.keyChange = true;\n    this.setState({\n      value: this.simpleMde!.value()\n    });\n    this.props.onChange(this.simpleMde!.value());\n  };\n\n  removeEvents = () => {\n    if (this.editorEl && this.editorToolbarEl) {\n      this.editorEl.removeEventListener(\"keyup\", this.eventWrapper);\n      this.editorEl.removeEventListener(\"paste\", this.eventWrapper);\n      this.editorToolbarEl.removeEventListener(\"click\", this.eventWrapper);\n    }\n  };\n\n  addEvents = () => {\n    if (this.elementWrapperRef && this.simpleMde) {\n      this.editorEl = this.elementWrapperRef;\n      this.editorToolbarEl = this.elementWrapperRef.getElementsByClassName(\n        \"editor-toolbar\"\n      )[0];\n\n      this.editorEl.addEventListener(\"keyup\", this.eventWrapper);\n      this.editorEl.addEventListener(\"paste\", this.eventWrapper);\n      this.editorToolbarEl &&\n        this.editorToolbarEl.addEventListener(\"click\", this.eventWrapper);\n\n      this.simpleMde.codemirror.on(\"cursorActivity\", this.getCursor);\n\n      const { events } = this.props;\n\n      // Handle custom events\n      events &&\n        Object.entries(events).forEach(([eventName, callback]) => {\n          if (eventName && callback) {\n            this.simpleMde &&\n              this.simpleMde.codemirror.on(\n                eventName as DOMEvent,\n                callback as any\n              );\n          }\n        });\n    }\n  };\n\n  getCursor = () => {\n    // https://codemirror.net/doc/manual.html#api_selection\n    if (this.props.getLineAndCursor) {\n      this.props.getLineAndCursor(\n        this.simpleMde!.codemirror.getDoc().getCursor()\n      );\n    }\n  };\n\n  getMdeInstance = () => {\n    if (this.props.getMdeInstance) {\n      this.props.getMdeInstance(this.simpleMde!);\n    }\n  };\n\n  addExtraKeys = () => {\n    // https://codemirror.net/doc/manual.html#option_extraKeys\n    if (this.props.extraKeys) {\n      this.simpleMde!.codemirror.setOption(\"extraKeys\", this.props.extraKeys);\n    }\n  };\n\n  render() {\n    const {\n      events,\n      value,\n      options,\n      children,\n      extraKeys,\n      getLineAndCursor,\n      getMdeInstance,\n      label,\n      onChange,\n      id,\n      ...rest\n    } = this.props;\n    return (\n      <div id={`${this.id}-wrapper`} {...rest} ref={this.setElementWrapperRef}>\n        {label && <label htmlFor={this.id}> {label} </label>}\n        <textarea id={this.id} />\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"script"}